-- Seed BOMs and their components from embedded TSV
-- Columns: BOM_number, ITEM, id_product, description_short, ITEM_2, Qty, Unit, Procurement_type

WITH raw(tsv) AS (
  VALUES ($$BOM_number	ITEM	id_product	description_short	ITEM_2	Qty	Unit	Procurement_type
SO-615	IT-000004		PH10	IT-000004	1		Acheté
SO-616	IT-000003		PH9	IT-000003	1		Acheté
SO-617	IT-000002		PH7	IT-000002	1		Acheté
SO-619	IT-000001		PH4	IT-000001	1		Acheté
SO-620	IT-000006		650 mV	IT-000006	1		Acheté
SO-621	IT-000007		475 mV	IT-000007	1		Acheté
SO-622	IT-000008		STORAGE	IT-000008	1		Acheté
SO-1640	IT-000001		PH4	IT-000001	1		Acheté
SO-1640	IT-000002		PH7	IT-000002	1		Acheté
SO-1640	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1641	IT-000003		PH9	IT-000003	1		Acheté
SO-1641	IT-000002		PH7	IT-000002	1		Acheté
SO-1641	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1642	IT-000004		PH10	IT-000004	1		Acheté
SO-1642	IT-000002		PH7	IT-000002	1		Acheté
SO-1642	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1643	IT-000002		PH7	IT-000002	1		Acheté
SO-1643	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1644	IT-000006		650 mV	IT-000006	1		Acheté
SO-1644	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1645	IT-000007		475 mV	IT-000007	1		Acheté
SO-1645	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1646	IT-000008		STORAGE	IT-000008	1		Acheté
SO-1646	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1647	IT-000001		PH4	IT-000001	1		Acheté
SO-1647	IT-000002		PH7	IT-000002	1		Acheté
SO-1647	IT-000008		STORAGE	IT-000008	1		Acheté
SO-1647	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1647	IT-000010		Bottle	IT-000010	1		Acheté
SO-1648	IT-000003		PH9	IT-000003	1		Acheté
SO-1648	IT-000002		PH7	IT-000002	1		Acheté
SO-1648	IT-000008		STORAGE	IT-000008	1		Acheté
SO-1648	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1648	IT-000010		Bottle	IT-000010	1		Acheté
SO-1649	IT-000004		PH10	IT-000004	1		Acheté
SO-1649	IT-000002		PH7	IT-000002	1		Acheté
SO-1649	IT-000008		STORAGE	IT-000008	1		Acheté
SO-1649	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1649	IT-000010		Bottle	IT-000010	1		Acheté
SO-1650	IT-000002		PH7	IT-000002	1		Acheté
SO-1650	IT-000008		STORAGE	IT-000008	1		Acheté
SO-1650	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1650	IT-000010		Bottle	IT-000010	1		Acheté
SO-1651	IT-000006		650 mV	IT-000006	1		Acheté
SO-1651	IT-000008		STORAGE	IT-000008	1		Acheté
SO-1651	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1651	IT-000010		Bottle	IT-000010	1		Acheté
SO-1652	IT-000007		475 mV	IT-000007	1		Acheté
SO-1652	IT-000008		STORAGE	IT-000008	1		Acheté
SO-1652	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1652	IT-000010		Bottle	IT-000010	1		Acheté
SO-1911	IT-000005		PH7,5	IT-000005	1		Acheté
SO-2840	IT-000006		650 mV	IT-000006	1		Acheté
SO-2840	IT-000008		STORAGE	IT-000008	1		Acheté
SO-2840	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2840	IT-000010		Bottle	IT-000010	1		Acheté
SO-2840	IT-000059		Label 700 mV-Qty 48	IT-000059	1		Acheté
SO-2841	IT-000006		650 mV	IT-000006	1		Acheté
SO-2841	IT-000059		Label 700 mV-Qty 48	IT-000059	1		Acheté
SO-2845	IT-000006		650 mV	IT-000006	1		Acheté
SO-2845	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2845	IT-000059		Label 700 mV-Qty 48	IT-000059	1		Acheté
SO-2846	IT-000007		475 mV	IT-000007	1		Acheté
SO-2846	IT-000062		Label 470 mV-Qty 48	IT-000062	1		Acheté
SO-2847	IT-000007		475 mV	IT-000007	1		Acheté
SO-2847	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2847	IT-000062		Label 470 mV-Qty 48	IT-000062	1		Acheté
SO-2848	IT-000007		475 mV	IT-000007	1		Acheté
SO-2848	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2848	IT-000010		Bottle	IT-000010	1		Acheté
SO-2848	IT-000062		Label 470 mV-Qty 48	IT-000062	1		Acheté
SO-2849	IT-000007		475 mV	IT-000007	1		Acheté
SO-2849	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2849	IT-000010		Bottle	IT-000010	1		Acheté
SO-2849	IT-000061		Label 468 mV-Qty 48	IT-000061	1		Acheté
SO-2850	IT-000007		475 mV	IT-000007	1		Acheté
SO-2850	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2850	IT-000061		Label 468 mV-Qty 48	IT-000061	1		Acheté
SO-2851	IT-000007		475 mV	IT-000007	1		Acheté
SO-2851	IT-000061		Label 468 mV-Qty 48	IT-000061	1		Acheté
SO-2852	IT-000007		475 mV	IT-000007	1		Acheté
SO-2852	IT-000060		Label 465 mV-Qty 48	IT-000060	1		Acheté
SO-2853	IT-000007		475 mV	IT-000007	1		Acheté
SO-2853	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2853	IT-000060		Label 465 mV-Qty 48	IT-000060	1		Acheté
SO-2854	IT-000007		475 mV	IT-000007	1		Acheté
SO-2854	IT-000008		STORAGE	IT-000008	1		Acheté
SO-2854	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2854	IT-000010		Bottle	IT-000010	1		Acheté
SO-2854	IT-000060		Label 465 mV-Qty 48	IT-000060	1		Acheté
SO-2896	IT-000005		PH7,5	IT-000005	1		Acheté
SO-2896	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2903	IT-000005		PH7,5	IT-000005	1		Acheté
SO-2903	IT-000008		STORAGE	IT-000008	1		Acheté
SO-2903	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2903	IT-000010		Bottle	IT-000010	1		Acheté
SO-2944	IT-000065		200mV Redox	IT-000065	1		Acheté
SO-3232	IT-000065		200mV Redox	IT-000065	1		Acheté
SO-3232	IT-000063		Label 240 mV-Qty 48	IT-000063	1		Acheté
SO-3233	IT-000065		200mV Redox	IT-000065	1		Acheté
SO-3233	IT-000066		Label 220 mV-Qty 48	IT-000066	1		Acheté
SO-1639	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté
SO-1639	IT-000048		Bouchon short	IT-000048	1		Obselete
SO-1653	IT-000040		20mm 1/2 "	IT-000040	1		Acheté
SO-1654	IT-000041		25mm 1/2 "	IT-000041	1		Acheté
SO-1655	IT-000042		32mm 1/2 "	IT-000042	1		Acheté
SO-1656	IT-000043		40mm 1/2 "	IT-000043	1		Acheté
SO-1657	IT-000044		50mm 1/2 "	IT-000044	1		Acheté
SO-1658	IT-000045		63mm 1/2 "	IT-000045	1		Acheté
SO-3170	IT-000046		Bouchon pour porte-sonde SEKO	IT-000046	1		Obselete
SO-3171	IT-000047		Porte sonde Zodiac pour R0819800 et R0819900	IT-000047	1		Obselete
SO-1637	IT-000023		PORTE-SONDE 1/2	IT-000023	1		Acheté
SO-1638	IT-000009		Bouchon Blue	IT-000009	1		Acheté
S010	IT-000011		S150CD	IT-000011	1		Acheté
S010	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S015	IT-000011		S150CD	IT-000011	1		Acheté
S015	IT-000012		PG13,5	IT-000012	1		Acheté
S015	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S020	IT-000011		S150CD	IT-000011	1		Acheté
S020	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté
S020	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S025	IT-000014		S120C	IT-000014	1		Acheté
S025	IT-000015		JoHN GUEST 1/4-10mm	IT-000015	1		Acheté
S025	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S030	IT-000049		S150CD-80mm	IT-000049	1		Acheté
S030	IT-000077		Assy 80mm	IT-000077	1		Sub_assy
S030	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S040	IT-000011		S150CD	IT-000011	1		Acheté
S040	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S050	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S050	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté
S050	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S060	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S070	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S070	IT-000012		PG13,5	IT-000012	1		Acheté
S070	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S080	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S080	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S090	IT-000011		S150CD	IT-000011	1		Acheté
S090	IT-000023		PORTE-SONDE 1/2	IT-000023	1		Acheté
S090	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S100	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S100	IT-000023		PORTE-SONDE 1/2	IT-000023	1		Acheté
S100	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S120	IT-000011		S150CD	IT-000011	1		Acheté
S120	IT-000098		Connecteur MCX	IT-000098	1		Acheté
S120	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S130	IT-000030		S120C-ORP	IT-000030	1		Acheté
S130	IT-000098		Connecteur MCX	IT-000098	1		Acheté
S130	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S150	IT-000026		S224C	IT-000026	1		Acheté
S160	IT-000027		S224CD-ORP	IT-000027	1		Acheté
S170	IT-000050		S150CD-ORP-80 mm	IT-000050	1		Acheté
S170	IT-000077		Assy 80mm	IT-000077	1		Sub_assy
S170	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S180	IT-000011		S150CD	IT-000011	1		Acheté
S180	IT-000012		PG13,5	IT-000012	1		Acheté
S180	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S190	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S190	IT-000012		PG13,5	IT-000012	1		Acheté
S190	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S200	IT-000011		S150CD	IT-000011	1		Acheté
S200	IT-000028		EMEC rondelle	IT-000028	1		Fabriqué
S200	IT-000033		O-RING 12*3	IT-000033	1		Acheté
S200	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S210	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S210	IT-000028		EMEC rondelle	IT-000028	1		Fabriqué
S210	IT-000033		O-RING 12*3	IT-000033	1		Acheté
S210	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S220	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
S220	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S230	IT-000037		?	IT-000037	1		Obselete
S250	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
S250	IT-000012		PG13,5	IT-000012	1		Acheté
S250	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S260	IT-000030		S120C-ORP	IT-000030	1		Acheté
S260	IT-000015		JoHN GUEST 1/4-10mm	IT-000015	1		Acheté
S260	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S270	IT-000014		S120C	IT-000014	1		Acheté
S270	IT-000015		JoHN GUEST 1/4-10mm	IT-000015	1		Acheté
S270	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S280	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
S280	IT-000077		Assy 80mm	IT-000077	1		Sub_assy
S280	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S290	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S290	IT-000104		O-RING 12*2	IT-000104	1		Acheté
S290	IT-000031		Bayrol003	IT-000031	1		Fabriqué
S290	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
S290	IT-000103		O-RING 11*3	IT-000103	1		Acheté
S290	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S300	IT-000011		S150CD	IT-000011	1		Acheté
S300	IT-000104		O-RING 12*2	IT-000104	1		Acheté
S300	IT-000031		Bayrol003	IT-000031	1		Fabriqué
S300	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
S300	IT-000103		O-RING 11*3	IT-000103	1		Acheté
S320	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S320	IT-000032		EZ001	IT-000032	1		Fabriqué
S320	IT-000033		O-RING 12*3	IT-000033	1		Acheté
S320	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S330	IT-000011		S150CD	IT-000011	1		Acheté
S330	IT-000032		EZ001	IT-000032	1		Fabriqué
S330	IT-000033		O-RING 12*3	IT-000033	1		Acheté
S330	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S340	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
S340	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté
S340	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S300	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S350	IT-000011		S150CD	IT-000011	1		Acheté
S350	IT-000104		O-RING 12*2	IT-000104	1		Acheté
S350	IT-000031		Bayrol003	IT-000031	1		Fabriqué
S370	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
S370	IT-000036		kaq2435b	IT-000036	1		Fabriqué
S370	IT-000033		O-RING 12*3	IT-000033	1		Acheté
S370	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S380	IT-000049		S150CD-80mm	IT-000049	1		Acheté
S380	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S390	IT-000050		S150CD-ORP-80 mm	IT-000050	1		Acheté
S390	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S350	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
S350	IT-000103		O-RING 11*3	IT-000103	1		Acheté
S350	IT-000034		(DIN-EL connector)SN6	IT-000034	1		Acheté
S350	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S360	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
S360	IT-000104		O-RING 12*2	IT-000104	1		Acheté
S360	IT-000031		Bayrol003	IT-000031	1		Fabriqué
S360	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
S360	IT-000103		O-RING 11*3	IT-000103	1		Acheté
S360	IT-000034		(DIN-EL connector)SN6	IT-000034	1		Acheté
S360	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S310	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
S310	IT-000104		O-RING 12*2	IT-000104	1		Acheté
S310	IT-000031		Bayrol003	IT-000031	1		Fabriqué
S310	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
S310	IT-000103		O-RING 11*3	IT-000103	1		Acheté
S310	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S400	IT-000011		S150CD	IT-000011	1		Acheté
S400	IT-000104		O-RING 12*2	IT-000104	1		Acheté
S400	IT-000031		Bayrol003	IT-000031	1		Fabriqué
S400	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
S400	IT-000103		O-RING 11*3	IT-000103	1		Acheté
S400	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S410	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
S410	IT-000104		O-RING 12*2	IT-000104	1		Acheté
S410	IT-000031		Bayrol003	IT-000031	1		Fabriqué
S410	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
S410	IT-000103		O-RING 11*3	IT-000103	1		Acheté
S410	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S420	IT-000011		S150CD	IT-000011	1		Acheté
S420	IT-000028		EMEC rondelle	IT-000028	1		Fabriqué
S420	IT-000033		O-RING 12*3	IT-000033	1		Acheté
S420	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S430	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S430	IT-000028		EMEC rondelle	IT-000028	1		Fabriqué
S430	IT-000033		O-RING 12*3	IT-000033	1		Acheté
S430	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S440	IT-000011		S150CD	IT-000011	1		Acheté
S440	IT-000116		MCX 90	IT-000116	1		Acheté
S440	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S450	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S450	IT-000116		MCX 90	IT-000116	1		Acheté
S450	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S460	IT-000011						Acheté
S460	IT-000001		PH4	IT-000001			Acheté
S460	IT-000053		Large box -215*160*43	IT-000053			Acheté
IT-000077	IT-000016		BOUCHON  80 mm	IT-000016	1		Fabriqué
IT-000077	IT-000017		entretoise001	IT-000017	2		Fabriqué
IT-000077	IT-000018		entretoise new _v1	IT-000018	1		Fabriqué
IT-000077	IT-000019		O-RING 12*2,5	IT-000019	2		Acheté
IT-000078	IT-000011		S150CD	IT-000011	1		Acheté
IT-000078	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté
IT-000079	IT-000021		S150CD-ORP	IT-000021	1		Acheté
IT-000079	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté
IT-000080	IT-000014		S120C	IT-000014	1		Acheté
IT-000080	IT-000015		JoHN GUEST 1/4-10mm	IT-000015	1		Acheté
IT-000081	IT-000030		S120C-ORP	IT-000030	1		Acheté
IT-000081	IT-000015		JoHN GUEST 1/4-10mm	IT-000015	1		Acheté
IT-000082	IT-000011		S150CD	IT-000011	1		Acheté
IT-000082	IT-000012		PG13,5	IT-000012	1		Acheté
IT-000083	IT-000021		S150CD-ORP	IT-000021	1		Acheté
IT-000083	IT-000012		PG13,5	IT-000012	1		Acheté
IT-000084	IT-000011		S150CD	IT-000011	1		Acheté
IT-000084	IT-000028		EMEC rondelle	IT-000028	1		Fabriqué
IT-000084	IT-000033		O-RING 12*3	IT-000033	1		Acheté
IT-000085	IT-000021		S150CD-ORP	IT-000021	1		Acheté
IT-000085	IT-000028		EMEC rondelle	IT-000028	1		Fabriqué
IT-000085	IT-000033		O-RING 12*3	IT-000033	1		Acheté
IT-000086	IT-000021		S150CD-ORP	IT-000021	1		Acheté
IT-000086	IT-000031		Bayrol003	IT-000031	1		Fabriqué
IT-000086	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
IT-000086	IT-000103		O-RING 11*3	IT-000103	1		Acheté
IT-000086	IT-000104		O-RING 12*2	IT-000104	1		Acheté
IT-000087	IT-000011		S150CD	IT-000011	1		Acheté
IT-000087	IT-000031		Bayrol003	IT-000031	1		Fabriqué
IT-000087	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
IT-000087	IT-000103		O-RING 11*3	IT-000103	1		Acheté
IT-000087	IT-000104		O-RING 12*2	IT-000104	1		Acheté
IT-000088	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
IT-000088	IT-000031		Bayrol003	IT-000031	1		Fabriqué
IT-000088	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
IT-000088	IT-000103		O-RING 11*3	IT-000103	1		Acheté
IT-000088	IT-000104		O-RING 12*2	IT-000104	1		Acheté
IT-000089	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
IT-000089	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté
IT-000090	IT-000011		S150CD	IT-000011	1		Acheté
IT-000090	IT-000031		Bayrol003	IT-000031	1		Fabriqué
IT-000090	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
IT-000090	IT-000103		O-RING 11*3	IT-000103	1		Acheté
IT-000090	IT-000104		O-RING 12*2	IT-000104	1		Acheté
IT-000090	IT-000034		(DIN-EL connector)SN6	IT-000034	1		Acheté
IT-000091	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
IT-000091	IT-000031		Bayrol003	IT-000031	1		Fabriqué
IT-000091	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
IT-000091	IT-000103		O-RING 11*3	IT-000103	1		Acheté
IT-000091	IT-000104		O-RING 12*2	IT-000104	1		Acheté
IT-000091	IT-000034		(DIN-EL connector)SN6	IT-000034	1		Acheté
IT-000092	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
IT-000092	IT-000036		kaq2435b	IT-000036	1		Fabriqué
IT-000092	IT-000033		O-RING 12*3	IT-000033	2		Acheté
IT-000093	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté
IT-000093	IT-000009		Bouchon Blue	IT-000009	1		Acheté
IT-000094	IT-000011		S150CD	IT-000011	1		Acheté
IT-000094	IT-000067		Gaine thermo ROUGE	IT-000067	25		Acheté
IT-000094	IT-000096		Gaine thermo NOIR	IT-000096	25		Acheté
IT-000095	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
IT-000095	IT-000067		Gaine thermo ROUGE	IT-000067	25		Acheté
IT-000095	IT-000096		Gaine thermo NOIR	IT-000096	25		Acheté
IT-000097	IT-000011		S150CD	IT-000011	1		Acheté
IT-000097	IT-000098		Connecteur MCX	IT-000098	1		Acheté
IT-000099	IT-000014		S120C	IT-000014	1		Acheté
IT-000099	IT-000015		JoHN GUEST 1/4-10mm	IT-000015	1		Acheté
IT-000099	IT-000098		Connecteur MCX	IT-000098	1		Acheté
IT-000100	IT-000030		S120C-ORP	IT-000030	1		Acheté
IT-000100	IT-000015		JoHN GUEST 1/4-10mm	IT-000015	1		Acheté
IT-000100	IT-000098		Connecteur MCX	IT-000098	1		Acheté
CO-1653	IT-000040		20mm 1/2 "	IT-000040	1		Acheté
CO-1654	IT-000041		25mm 1/2 "	IT-000041	1		Acheté
CO-1655	IT-000042		32mm 1/2 "	IT-000042	1		Acheté
CO-1656	IT-000043		40mm 1/2 "	IT-000043	1		Acheté
CO-1657	IT-000044		50mm 1/2 "	IT-000044	1		Acheté
CO-1658	IT-000045		63mm 1/2 "	IT-000045	1		Acheté
AC-1637	IT-000023		PORTE-SONDE 1/2	IT-000023	1		Acheté
AC-1638	IT-000009		Bouchon Blue	IT-000009	1		Acheté
AC-1639	IT-000009		Bouchon Blue	IT-000009	1		Acheté
AC-1639	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté$$)
)
, lines AS (
  SELECT regexp_split_to_table(replace(tsv, E'\r', ''), E'\n') AS line
  FROM raw
)
, parsed AS (
  SELECT
    nullif(btrim((string_to_array(line, E'\t'))[1]), '') AS bom_number,
    nullif(btrim((string_to_array(line, E'\t'))[2]), '') AS item_root,
    nullif(btrim((string_to_array(line, E'\t'))[3]), '') AS id_product,
    nullif(btrim((string_to_array(line, E'\t'))[4]), '') AS description_short,
    nullif(btrim((string_to_array(line, E'\t'))[5]), '') AS item_component,
    nullif(btrim((string_to_array(line, E'\t'))[6]), '') AS qty_str,
    nullif(btrim((string_to_array(line, E'\t'))[7]), '') AS unit,
    nullif(btrim((string_to_array(line, E'\t'))[8]), '') AS procurement_type
  FROM lines
)
, rows AS (
  SELECT * FROM parsed OFFSET 1 -- skip header
)
-- Create BOMs by unique BOM_number (name)
INSERT INTO mod_bom_boms(org_id, name, description, created_at, updated_at)
SELECT NULL, r.bom_number, NULL, NOW(), NOW()
  FROM (SELECT DISTINCT bom_number FROM rows WHERE bom_number IS NOT NULL AND bom_number <> '') r
 WHERE NOT EXISTS (
   SELECT 1 FROM mod_bom_boms b WHERE b.name = r.bom_number
 );

-- Insert BOM items (components)
WITH raw2(tsv) AS (
  VALUES ($$BOM_number	ITEM	id_product	description_short	ITEM_2	Qty	Unit	Procurement_type
SO-615	IT-000004		PH10	IT-000004	1		Acheté
SO-616	IT-000003		PH9	IT-000003	1		Acheté
SO-617	IT-000002		PH7	IT-000002	1		Acheté
SO-619	IT-000001		PH4	IT-000001	1		Acheté
SO-620	IT-000006		650 mV	IT-000006	1		Acheté
SO-621	IT-000007		475 mV	IT-000007	1		Acheté
SO-622	IT-000008		STORAGE	IT-000008	1		Acheté
SO-1640	IT-000001		PH4	IT-000001	1		Acheté
SO-1640	IT-000002		PH7	IT-000002	1		Acheté
SO-1640	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1641	IT-000003		PH9	IT-000003	1		Acheté
SO-1641	IT-000002		PH7	IT-000002	1		Acheté
SO-1641	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1642	IT-000004		PH10	IT-000004	1		Acheté
SO-1642	IT-000002		PH7	IT-000002	1		Acheté
SO-1642	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1643	IT-000002		PH7	IT-000002	1		Acheté
SO-1643	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1644	IT-000006		650 mV	IT-000006	1		Acheté
SO-1644	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1645	IT-000007		475 mV	IT-000007	1		Acheté
SO-1645	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1646	IT-000008		STORAGE	IT-000008	1		Acheté
SO-1646	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1647	IT-000001		PH4	IT-000001	1		Acheté
SO-1647	IT-000002		PH7	IT-000002	1		Acheté
SO-1647	IT-000008		STORAGE	IT-000008	1		Acheté
SO-1647	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1647	IT-000010		Bottle	IT-000010	1		Acheté
SO-1648	IT-000003		PH9	IT-000003	1		Acheté
SO-1648	IT-000002		PH7	IT-000002	1		Acheté
SO-1648	IT-000008		STORAGE	IT-000008	1		Acheté
SO-1648	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1648	IT-000010		Bottle	IT-000010	1		Acheté
SO-1649	IT-000004		PH10	IT-000004	1		Acheté
SO-1649	IT-000002		PH7	IT-000002	1		Acheté
SO-1649	IT-000008		STORAGE	IT-000008	1		Acheté
SO-1649	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1649	IT-000010		Bottle	IT-000010	1		Acheté
SO-1650	IT-000002		PH7	IT-000002	1		Acheté
SO-1650	IT-000008		STORAGE	IT-000008	1		Acheté
SO-1650	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1650	IT-000010		Bottle	IT-000010	1		Acheté
SO-1651	IT-000006		650 mV	IT-000006	1		Acheté
SO-1651	IT-000008		STORAGE	IT-000008	1		Acheté
SO-1651	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1651	IT-000010		Bottle	IT-000010	1		Acheté
SO-1652	IT-000007		475 mV	IT-000007	1		Acheté
SO-1652	IT-000008		STORAGE	IT-000008	1		Acheté
SO-1652	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-1652	IT-000010		Bottle	IT-000010	1		Acheté
SO-1911	IT-000005		PH7,5	IT-000005	1		Acheté
SO-2840	IT-000006		650 mV	IT-000006	1		Acheté
SO-2840	IT-000008		STORAGE	IT-000008	1		Acheté
SO-2840	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2840	IT-000010		Bottle	IT-000010	1		Acheté
SO-2840	IT-000059		Label 700 mV-Qty 48	IT-000059	1		Acheté
SO-2841	IT-000006		650 mV	IT-000006	1		Acheté
SO-2841	IT-000059		Label 700 mV-Qty 48	IT-000059	1		Acheté
SO-2845	IT-000006		650 mV	IT-000006	1		Acheté
SO-2845	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2845	IT-000059		Label 700 mV-Qty 48	IT-000059	1		Acheté
SO-2846	IT-000007		475 mV	IT-000007	1		Acheté
SO-2846	IT-000062		Label 470 mV-Qty 48	IT-000062	1		Acheté
SO-2847	IT-000007		475 mV	IT-000007	1		Acheté
SO-2847	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2847	IT-000062		Label 470 mV-Qty 48	IT-000062	1		Acheté
SO-2848	IT-000007		475 mV	IT-000007	1		Acheté
SO-2848	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2848	IT-000010		Bottle	IT-000010	1		Acheté
SO-2848	IT-000062		Label 470 mV-Qty 48	IT-000062	1		Acheté
SO-2849	IT-000007		475 mV	IT-000007	1		Acheté
SO-2849	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2849	IT-000010		Bottle	IT-000010	1		Acheté
SO-2849	IT-000061		Label 468 mV-Qty 48	IT-000061	1		Acheté
SO-2850	IT-000007		475 mV	IT-000007	1		Acheté
SO-2850	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2850	IT-000061		Label 468 mV-Qty 48	IT-000061	1		Acheté
SO-2851	IT-000007		475 mV	IT-000007	1		Acheté
SO-2851	IT-000061		Label 468 mV-Qty 48	IT-000061	1		Acheté
SO-2852	IT-000007		475 mV	IT-000007	1		Acheté
SO-2852	IT-000060		Label 465 mV-Qty 48	IT-000060	1		Acheté
SO-2853	IT-000007		475 mV	IT-000007	1		Acheté
SO-2853	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2853	IT-000060		Label 465 mV-Qty 48	IT-000060	1		Acheté
SO-2854	IT-000007		475 mV	IT-000007	1		Acheté
SO-2854	IT-000008		STORAGE	IT-000008	1		Acheté
SO-2854	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2854	IT-000010		Bottle	IT-000010	1		Acheté
SO-2854	IT-000060		Label 465 mV-Qty 48	IT-000060	1		Acheté
SO-2896	IT-000005		PH7,5	IT-000005	1		Acheté
SO-2896	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2903	IT-000005		PH7,5	IT-000005	1		Acheté
SO-2903	IT-000008		STORAGE	IT-000008	1		Acheté
SO-2903	IT-000009		Bouchon Blue	IT-000009	1		Acheté
SO-2903	IT-000010		Bottle	IT-000010	1		Acheté
SO-2944	IT-000065		200mV Redox	IT-000065	1		Acheté
SO-3232	IT-000065		200mV Redox	IT-000065	1		Acheté
SO-3232	IT-000063		Label 240 mV-Qty 48	IT-000063	1		Acheté
SO-3233	IT-000065		200mV Redox	IT-000065	1		Acheté
SO-3233	IT-000066		Label 220 mV-Qty 48	IT-000066	1		Acheté
SO-1639	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté
SO-1639	IT-000048		Bouchon short	IT-000048	1		Obselete
SO-1653	IT-000040		20mm 1/2 "	IT-000040	1		Acheté
SO-1654	IT-000041		25mm 1/2 "	IT-000041	1		Acheté
SO-1655	IT-000042		32mm 1/2 "	IT-000042	1		Acheté
SO-1656	IT-000043		40mm 1/2 "	IT-000043	1		Acheté
SO-1657	IT-000044		50mm 1/2 "	IT-000044	1		Acheté
SO-1658	IT-000045		63mm 1/2 "	IT-000045	1		Acheté
SO-3170	IT-000046		Bouchon pour porte-sonde SEKO	IT-000046	1		Obselete
SO-3171	IT-000047		Porte sonde Zodiac pour R0819800 et R0819900	IT-000047	1		Obselete
SO-1637	IT-000023		PORTE-SONDE 1/2	IT-000023	1		Acheté
SO-1638	IT-000009		Bouchon Blue	IT-000009	1		Acheté
S010	IT-000011		S150CD	IT-000011	1		Acheté
S010	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S015	IT-000011		S150CD	IT-000011	1		Acheté
S015	IT-000012		PG13,5	IT-000012	1		Acheté
S015	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S020	IT-000011		S150CD	IT-000011	1		Acheté
S020	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté
S020	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S025	IT-000014		S120C	IT-000014	1		Acheté
S025	IT-000015		JoHN GUEST 1/4-10mm	IT-000015	1		Acheté
S025	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S030	IT-000049		S150CD-80mm	IT-000049	1		Acheté
S030	IT-000077		Assy 80mm	IT-000077	1		Sub_assy
S030	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S040	IT-000011		S150CD	IT-000011	1		Acheté
S040	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S050	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S050	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté
S050	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S060	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S070	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S070	IT-000012		PG13,5	IT-000012	1		Acheté
S070	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S080	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S080	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S090	IT-000011		S150CD	IT-000011	1		Acheté
S090	IT-000023		PORTE-SONDE 1/2	IT-000023	1		Acheté
S090	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S100	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S100	IT-000023		PORTE-SONDE 1/2	IT-000023	1		Acheté
S100	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S120	IT-000011		S150CD	IT-000011	1		Acheté
S120	IT-000098		Connecteur MCX	IT-000098	1		Acheté
S120	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S130	IT-000030		S120C-ORP	IT-000030	1		Acheté
S130	IT-000098		Connecteur MCX	IT-000098	1		Acheté
S130	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S150	IT-000026		S224C	IT-000026	1		Acheté
S160	IT-000027		S224CD-ORP	IT-000027	1		Acheté
S170	IT-000050		S150CD-ORP-80 mm	IT-000050	1		Acheté
S170	IT-000077		Assy 80mm	IT-000077	1		Sub_assy
S170	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S180	IT-000011		S150CD	IT-000011	1		Acheté
S180	IT-000012		PG13,5	IT-000012	1		Acheté
S180	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S190	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S190	IT-000012		PG13,5	IT-000012	1		Acheté
S190	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S200	IT-000011		S150CD	IT-000011	1		Acheté
S200	IT-000028		EMEC rondelle	IT-000028	1		Fabriqué
S200	IT-000033		O-RING 12*3	IT-000033	1		Acheté
S200	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S210	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S210	IT-000028		EMEC rondelle	IT-000028	1		Fabriqué
S210	IT-000033		O-RING 12*3	IT-000033	1		Acheté
S210	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S220	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
S220	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S230	IT-000037		?	IT-000037	1		Obselete
S250	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
S250	IT-000012		PG13,5	IT-000012	1		Acheté
S250	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S260	IT-000030		S120C-ORP	IT-000030	1		Acheté
S260	IT-000015		JoHN GUEST 1/4-10mm	IT-000015	1		Acheté
S260	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S270	IT-000014		S120C	IT-000014	1		Acheté
S270	IT-000015		JoHN GUEST 1/4-10mm	IT-000015	1		Acheté
S270	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S280	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
S280	IT-000077		Assy 80mm	IT-000077	1		Sub_assy
S280	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S290	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S290	IT-000104		O-RING 12*2	IT-000104	1		Acheté
S290	IT-000031		Bayrol003	IT-000031	1		Fabriqué
S290	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
S290	IT-000103		O-RING 11*3	IT-000103	1		Acheté
S290	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S300	IT-000011		S150CD	IT-000011	1		Acheté
S300	IT-000104		O-RING 12*2	IT-000104	1		Acheté
S300	IT-000031		Bayrol003	IT-000031	1		Fabriqué
S300	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
S300	IT-000103		O-RING 11*3	IT-000103	1		Acheté
S320	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S320	IT-000032		EZ001	IT-000032	1		Fabriqué
S320	IT-000033		O-RING 12*3	IT-000033	1		Acheté
S320	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S330	IT-000011		S150CD	IT-000011	1		Acheté
S330	IT-000032		EZ001	IT-000032	1		Fabriqué
S330	IT-000033		O-RING 12*3	IT-000033	1		Acheté
S330	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S340	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
S340	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté
S340	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S300	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S350	IT-000011		S150CD	IT-000011	1		Acheté
S350	IT-000104		O-RING 12*2	IT-000104	1		Acheté
S350	IT-000031		Bayrol003	IT-000031	1		Fabriqué
S370	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
S370	IT-000036		kaq2435b	IT-000036	1		Fabriqué
S370	IT-000033		O-RING 12*3	IT-000033	1		Acheté
S370	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S380	IT-000049		S150CD-80mm	IT-000049	1		Acheté
S380	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S390	IT-000050		S150CD-ORP-80 mm	IT-000050	1		Acheté
S390	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S350	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
S350	IT-000103		O-RING 11*3	IT-000103	1		Acheté
S350	IT-000034		(DIN-EL connector)SN6	IT-000034	1		Acheté
S350	IT-000118		Smal box 213x84x43mm	IT-000118	1		Acheté
S360	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
S360	IT-000104		O-RING 12*2	IT-000104	1		Acheté
S360	IT-000031		Bayrol003	IT-000031	1		Fabriqué
S360	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
S360	IT-000103		O-RING 11*3	IT-000103	1		Acheté
S360	IT-000034		(DIN-EL connector)SN6	IT-000034	1		Acheté
S360	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S310	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
S310	IT-000104		O-RING 12*2	IT-000104	1		Acheté
S310	IT-000031		Bayrol003	IT-000031	1		Fabriqué
S310	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
S310	IT-000103		O-RING 11*3	IT-000103	1		Acheté
S310	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S400	IT-000011		S150CD	IT-000011	1		Acheté
S400	IT-000104		O-RING 12*2	IT-000104	1		Acheté
S400	IT-000031		Bayrol003	IT-000031	1		Fabriqué
S400	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
S400	IT-000103		O-RING 11*3	IT-000103	1		Acheté
S400	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S410	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
S410	IT-000104		O-RING 12*2	IT-000104	1		Acheté
S410	IT-000031		Bayrol003	IT-000031	1		Fabriqué
S410	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
S410	IT-000103		O-RING 11*3	IT-000103	1		Acheté
S410	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S420	IT-000011		S150CD	IT-000011	1		Acheté
S420	IT-000028		EMEC rondelle	IT-000028	1		Fabriqué
S420	IT-000033		O-RING 12*3	IT-000033	1		Acheté
S420	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S430	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S430	IT-000028		EMEC rondelle	IT-000028	1		Fabriqué
S430	IT-000033		O-RING 12*3	IT-000033	1		Acheté
S430	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S440	IT-000011		S150CD	IT-000011	1		Acheté
S440	IT-000116		MCX 90	IT-000116	1		Acheté
S440	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S450	IT-000021		S150CD-ORP	IT-000021	1		Acheté
S450	IT-000116		MCX 90	IT-000116	1		Acheté
S450	IT-000053		Large box -215*160*43	IT-000053	1		Acheté
S460	IT-000011						Acheté
S460	IT-000001		PH4	IT-000001			Acheté
S460	IT-000053		Large box -215*160*43	IT-000053			Acheté
IT-000077	IT-000016		BOUCHON  80 mm	IT-000016	1		Fabriqué
IT-000077	IT-000017		entretoise001	IT-000017	2		Fabriqué
IT-000077	IT-000018		entretoise new _v1	IT-000018	1		Fabriqué
IT-000077	IT-000019		O-RING 12*2,5	IT-000019	2		Acheté
IT-000078	IT-000011		S150CD	IT-000011	1		Acheté
IT-000078	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté
IT-000079	IT-000021		S150CD-ORP	IT-000021	1		Acheté
IT-000079	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté
IT-000080	IT-000014		S120C	IT-000014	1		Acheté
IT-000080	IT-000015		JoHN GUEST 1/4-10mm	IT-000015	1		Acheté
IT-000081	IT-000030		S120C-ORP	IT-000030	1		Acheté
IT-000081	IT-000015		JoHN GUEST 1/4-10mm	IT-000015	1		Acheté
IT-000082	IT-000011		S150CD	IT-000011	1		Acheté
IT-000082	IT-000012		PG13,5	IT-000012	1		Acheté
IT-000083	IT-000021		S150CD-ORP	IT-000021	1		Acheté
IT-000083	IT-000012		PG13,5	IT-000012	1		Acheté
IT-000084	IT-000011		S150CD	IT-000011	1		Acheté
IT-000084	IT-000028		EMEC rondelle	IT-000028	1		Fabriqué
IT-000084	IT-000033		O-RING 12*3	IT-000033	1		Acheté
IT-000085	IT-000021		S150CD-ORP	IT-000021	1		Acheté
IT-000085	IT-000028		EMEC rondelle	IT-000028	1		Fabriqué
IT-000085	IT-000033		O-RING 12*3	IT-000033	1		Acheté
IT-000086	IT-000021		S150CD-ORP	IT-000021	1		Acheté
IT-000086	IT-000031		Bayrol003	IT-000031	1		Fabriqué
IT-000086	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
IT-000086	IT-000103		O-RING 11*3	IT-000103	1		Acheté
IT-000086	IT-000104		O-RING 12*2	IT-000104	1		Acheté
IT-000087	IT-000011		S150CD	IT-000011	1		Acheté
IT-000087	IT-000031		Bayrol003	IT-000031	1		Fabriqué
IT-000087	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
IT-000087	IT-000103		O-RING 11*3	IT-000103	1		Acheté
IT-000087	IT-000104		O-RING 12*2	IT-000104	1		Acheté
IT-000088	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
IT-000088	IT-000031		Bayrol003	IT-000031	1		Fabriqué
IT-000088	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
IT-000088	IT-000103		O-RING 11*3	IT-000103	1		Acheté
IT-000088	IT-000104		O-RING 12*2	IT-000104	1		Acheté
IT-000089	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
IT-000089	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté
IT-000090	IT-000011		S150CD	IT-000011	1		Acheté
IT-000090	IT-000031		Bayrol003	IT-000031	1		Fabriqué
IT-000090	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
IT-000090	IT-000103		O-RING 11*3	IT-000103	1		Acheté
IT-000090	IT-000104		O-RING 12*2	IT-000104	1		Acheté
IT-000090	IT-000034		(DIN-EL connector)SN6	IT-000034	1		Acheté
IT-000091	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
IT-000091	IT-000031		Bayrol003	IT-000031	1		Fabriqué
IT-000091	IT-000019		O-RING 12*2,5	IT-000019	1		Acheté
IT-000091	IT-000103		O-RING 11*3	IT-000103	1		Acheté
IT-000091	IT-000104		O-RING 12*2	IT-000104	1		Acheté
IT-000091	IT-000034		(DIN-EL connector)SN6	IT-000034	1		Acheté
IT-000092	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
IT-000092	IT-000036		kaq2435b	IT-000036	1		Fabriqué
IT-000092	IT-000033		O-RING 12*3	IT-000033	2		Acheté
IT-000093	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté
IT-000093	IT-000009		Bouchon Blue	IT-000009	1		Acheté
IT-000094	IT-000011		S150CD	IT-000011	1		Acheté
IT-000094	IT-000067		Gaine thermo ROUGE	IT-000067	25		Acheté
IT-000094	IT-000096		Gaine thermo NOIR	IT-000096	25		Acheté
IT-000095	IT-000029		S150CD-ORP-GOLD	IT-000029	1		Acheté
IT-000095	IT-000067		Gaine thermo ROUGE	IT-000067	25		Acheté
IT-000095	IT-000096		Gaine thermo NOIR	IT-000096	25		Acheté
IT-000097	IT-000011		S150CD	IT-000011	1		Acheté
IT-000097	IT-000098		Connecteur MCX	IT-000098	1		Acheté
IT-000099	IT-000014		S120C	IT-000014	1		Acheté
IT-000099	IT-000015		JoHN GUEST 1/4-10mm	IT-000015	1		Acheté
IT-000099	IT-000098		Connecteur MCX	IT-000098	1		Acheté
IT-000100	IT-000030		S120C-ORP	IT-000030	1		Acheté
IT-000100	IT-000015		JoHN GUEST 1/4-10mm	IT-000015	1		Acheté
IT-000100	IT-000098		Connecteur MCX	IT-000098	1		Acheté
CO-1653	IT-000040		20mm 1/2 "	IT-000040	1		Acheté
CO-1654	IT-000041		25mm 1/2 "	IT-000041	1		Acheté
CO-1655	IT-000042		32mm 1/2 "	IT-000042	1		Acheté
CO-1656	IT-000043		40mm 1/2 "	IT-000043	1		Acheté
CO-1657	IT-000044		50mm 1/2 "	IT-000044	1		Acheté
CO-1658	IT-000045		63mm 1/2 "	IT-000045	1		Acheté
AC-1637	IT-000023		PORTE-SONDE 1/2	IT-000023	1		Acheté
AC-1638	IT-000009		Bouchon Blue	IT-000009	1		Acheté
AC-1639	IT-000009		Bouchon Blue	IT-000009	1		Acheté
AC-1639	IT-000013		JoHN GUEST 1/2-12mm	IT-000013	1		Acheté$$)
), lines2 AS (
  SELECT regexp_split_to_table(replace(tsv, E'\r', ''), E'\n') AS line
  FROM raw2
), parsed2 AS (
  SELECT
    nullif(btrim((string_to_array(line, E'\t'))[1]), '') AS bom_number,
    nullif(btrim((string_to_array(line, E'\t'))[2]), '') AS item_root,
    nullif(btrim((string_to_array(line, E'\t'))[3]), '') AS id_product,
    nullif(btrim((string_to_array(line, E'\t'))[4]), '') AS description_short,
    nullif(btrim((string_to_array(line, E'\t'))[5]), '') AS item_component,
    nullif(btrim((string_to_array(line, E'\t'))[6]), '') AS qty_str,
    nullif(btrim((string_to_array(line, E'\t'))[7]), '') AS unit,
    nullif(btrim((string_to_array(line, E'\t'))[8]), '') AS procurement_type
  FROM lines2
), rows2 AS (
  SELECT * FROM parsed2 OFFSET 1 -- skip header
), qrows AS (
  SELECT
    lower(btrim(bom_number)) AS bom_key,
    lower(btrim(item_component)) AS comp_key,
    CASE WHEN qty_str ~ '^[0-9]+([\.,][0-9]+)?$' THEN CAST(REPLACE(qty_str, ',', '.') AS NUMERIC) ELSE 1 END AS qty
  FROM rows2
  WHERE item_component IS NOT NULL AND item_component <> ''
)
INSERT INTO mod_bom_bom_items(org_id, bom_id, item_id, quantity, position)
SELECT COALESCE(b.org_id, i.org_id), b.id, i.id, q.qty, NULL
  FROM qrows q
  JOIN mod_bom_boms b ON lower(btrim(b.name)) = q.bom_key
  JOIN mod_bom_items i ON lower(btrim(i.sku)) = q.comp_key
ON CONFLICT (bom_id, item_id) DO UPDATE SET quantity = EXCLUDED.quantity;
